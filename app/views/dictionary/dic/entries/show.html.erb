<%# app/views/dictionary/dic/entries/show.html.erb %>
<div class="dictionary-master-entry">
  <header class="entry-header">
    <nav><%= link_to "← New Search", dic_vocab_index_path(lang: @entry.lang) %></nav>

    <div class="word-main">
      <h1>
        <%= @entry.name %>
        <% if @index.homograph_no.present? %>
          <small class="homograph-no"><sup><%= @index.homograph_no %></sup></small>
        <% end %>
      </h1>
      <div class="tags">
        <span class="badge lang"><%= @entry.lang.upcase %></span>
        <span class="badge grammar"><%= @entry.grammar %></span>
        <span class="badge gender"><%= @entry.gender %></span>
      </div>
    </div>

    <% if @entry.etymology.present? %>
      <div class="etymology-section">
        <strong>Etymology:</strong> <%= @entry.etymology %>
      </div>
    <% end %>
  </header>

  <div class="entry-grid">
    <main class="entry-body">

      <%# 1. References (Ref) %>
      <% if @refs.any? %>
        <section class="dic-section">
          <h3>References</h3>
          <ul class="ref-list">
            <% @refs.each do |ref| %>
              <li>
                <strong><%= ref.citation_abbrev %></strong>
                <%= "Vol #{ref.citation_vol}" if ref.citation_vol.present? %>:
                <%= ref.ref_name %>
              </li>
            <% end %>
          </ul>
        </section>
      <% end %>

      <%# 2. Examples (Eg) %>
      <% if @egs.any? %>
        <section class="dic-section">
          <h3>Examples</h3>
          <% @egs.each do |eg| %>
            <div class="eg-item">
              <span class="eg-text">"<%= eg.eg_name %>"</span>
              <% if eg.eg_note.present? %><small class="eg-note">— <%= eg.eg_note %></small><% end %>
            </div>
          <% end %>
        </section>
      <% end %>

      <%# 3. Quotes %>
      <% if @quotes.any? %>
        <section class="dic-section">
          <h3>Citations & Quotes</h3>
          <% @quotes.each do |q| %>
            <div class="quote-block">
              <p class="quote-text"><%= q.quote_name %></p>
              <cite>— Source: <%= q.citation_abbrev %>, p. <%= q.citation_p %></cite>
            </div>
          <% end %>
        </section>
      <% end %>

      <%# 4. General Notes %>
      <% if @notes.any? %>
        <section class="dic-section notes-section">
          <h3>Editorial Notes</h3>
          <% @notes.each do |n| %>
            <div class="note-entry">
              <%= simple_format(n.note_note) %>
            </div>
          <% end %>
        </section>
      <% end %>

    </main>

<!--    <aside class="entry-sidebar">-->
      <%# if @scans.any? %>
<!--        <section class="scan-gallery">-->
<!--          <h4><i class="bi bi-image"></i> Manuscript Scans</h4>-->
<!--          <div class="scan-list">-->
            <%# @scans.each do |scan| %>
<!--              <div class="scan-item">-->
<!--                <span class="scan-name"><%#= scan.scan_filename %></span>-->

                <%# If you have the scan text/raw text, we can show a snippet %>
                <%# if scan.scan_text.present? %>
<!--                  <div class="scan-preview-text">-->
                    <%#= truncate(scan.scan_text, length: 100) %>
<!--                  </div>-->
                <%# end %>

<!--                <button class="btn-view-scan" data-filename="<%#= scan.scan_filename %>">-->
<!--                  Open Full Scan-->
<!--                </button>-->
<!--              </div>-->
            <%# end %>
<!--          </div>-->
<!--        </section>-->
      <%# end %>

<!--      <div class="entry-meta-card">-->
<!--        <h5>Source Info</h5>-->
<!--        <p><strong>File:</strong> <%#= @index.source_file %></p>-->
<!--        <p><strong>Order:</strong> <%#= @index.source_order %></p>-->
<!--        <p><strong>ID:</strong> <code class="small-id"><%#= @index.id %></code></p>-->
<!--      </div>-->
<!--    </aside>-->


  </div>
</div>